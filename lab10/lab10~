
;<Program title>

jmp start

;data


;code
start: nop
MVI A,02H
OUT 40H
MAIN: IN 41H
CPI 82H
JZ PROC_1
CPI 08H
JZ PROC_2
CPI 06H
JZ PROC_3
ANI 50H
CPI 50H
JZ PROC_4
JMP END

PROC_1: LDA 2301H
MOV B,A
LDA 2300H
MVI C,00H
DIV: SUB B
INR C
JNC DIV
DCR C
MOV A,C
STA 2310H
JMP MAIN

PROC_2: MVI A,55H
OUT 42H
CALL DELAY
MVI A,0AAH
OUT 42H
CALL DELAY 
JMP MAIN

PROC_3: MVI A,0CCH
XRI 12H
STA 2420H
LDA 2430H
MOV B,A
LDA 2420H
SUB B
STA 2440H

PROC_4: LXI H,2500H
MVI B,00H
LDA 2500H
STA 2150H
PUSH PSW
PUSH B
PUSH H
CALL DISPLAY
CALL DELAY
POP H
POP B
POP PSW
LOOP1: INX H
MOV A,B
CPI 20H
JZ MAIN
INR B
LDA 2150H
CMP M
JC LOOP2
JMP LOOP1
LOOP2: MOV A,M
STA 2150H
PUSH PSW
PUSH B
PUSH H
CALL DISPLAY
CALL DELAY
POP H
POP B
POP PSW
JMP LOOP1

DISPLAY: STA 2521H
RET

DELAY: MVI C,19H
LABEL1: MVI B,0FFH
LABEL2: MVI A,03FH
LABEL3: DCR A
JNZ LABEL3
DCR B
JNZ LABEL2
DCR C
JNZ LABEL1
RET

END: hlt